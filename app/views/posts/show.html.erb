<head>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script>
    $(document).ready(function(){
      $("#toggle-btn").click(function(){
        $("#toggle-example").collapse('toggle'); // toggle collapse
      });
    });
  </script>
</head>

<body>
  <div class="show-page">
    <div class="user-call">
      <%= current_user.username %>,
    </div>
    <div>
      Leave your comment here:
    </div>

  <div class="card-whole">
    <% if @post.spotify_track_id %>
      <div class="card-style">
        <% track = RSpotify::Track.find(@post.spotify_track_id) %>

        <div class="card-comments d-flex">
          <%= image_tag "avatar-kurt.png", class: "avatar" %>
          <div class="card-user-info">
            <h6><strong><%= current_user.email %></strong></h6>
            <%= @post.content %>
          </div>
        </div>

        <div class="d-flex">
          <% if @post.album_cover_url %>
            <div class="card-album-cover">
              <%= image_tag(@post.album_cover_url) %>
            </div>
          <% end %>

          <div class="card-info">
            <div>
              <p class="track-name"><strong><%= track.name %></strong></p>
              <p><%= track.artists.first.name %></p>
              <p><%= track.album.name %></p>
            </div>

            <div class="icons">
              <i class="fa-regular fa-heart"></i>
              <%= link_to post_path(@post) do %>
                <i class="fa-regular fa-comment"></i>
              <% end %>
              <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#modal-<%= @post.id %>">
                <i class="fa-solid fa-play"></i>
              </button>
              <h6><i class="fa-brands fa-spotify"></i></h6>
            </div>

          </div>
        </div>
      </div>
    <% end %>

    <%= render "song_modal", post: @post, track: track %>

    <div class="comments-section">

      <div class="all-comments">
        <div class="commented-ones" id="toggle-btn" data-toggle="collapse" data-target="#toggle-example">
          See all comments
        </div>
        <% @post.comments.each do |comment| %>
          <div id="toggle-example" class="collapse in">
            <%= comment.user.username %> said: <%= comment.content %>
          </div>
        <% end %>
      </div>

      <div class="new-comment">
        <%= simple_form_for [@post, @comment] do |f| %>
          <%= f.input :content, label: false, placeholder: "Write a comment", class: "input-comment" %>
          <div class="button-comment"><%= f.button :submit, ">>" %></div>
        <% end %>
      </div>

    </div>

  </div>
</body>
